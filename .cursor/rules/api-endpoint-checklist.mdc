---
description: "æ–°ã—ã„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ æ™‚ã®å¿…é ˆæ‰‹é †"
globs: backend/chat-router/template.yaml,backend/chat-router/src/handlers/*.py,backend/chat-router/src/lambda_function.py
alwaysApply: false
---
# APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æ–°ã—ã„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’**å¿…ãš**å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

## ğŸ“‹ å¿…é ˆæ‰‹é †

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…
- [ ] ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã®ä½œæˆ/æ›´æ–° (`src/handlers/`)
- [ ] `lambda_function.py` ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
- [ ] èªè¨¼ãŒå¿…è¦ãªå ´åˆã¯ `get_authenticated_user(headers)` ã‚’ä½¿ç”¨

### 2. âš ï¸ **é‡è¦**: API Gatewayè¨­å®š
- [ ] **`template.yaml`** ã«æ–°ã—ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®Eventsã‚’è¿½åŠ 
- [ ] æ­£ã—ã„Path, Methodã‚’æŒ‡å®š
- [ ] ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯ `{parameterId}` å½¢å¼ã§å®šç¾©

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…  
- [ ] `services/api.ts` ã«APIãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
- [ ] èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè‡ªå‹•ä»˜ä¸ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…

### 4. ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] `sam build` å®Ÿè¡Œ
- [ ] ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•
- [ ] ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å‹•ä½œç¢ºèª

## ğŸš¨ ã‚ˆãã‚ã‚‹è½ã¨ã—ç©´

- **template.yamlã®æ›´æ–°å¿˜ã‚Œ** â†’ "Missing Authentication Token" ã‚¨ãƒ©ãƒ¼
- èªè¨¼å‡¦ç†ã®å®Ÿè£…å¿˜ã‚Œ â†’ 401 Unauthorized ã‚¨ãƒ©ãƒ¼  
- ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä¸ä¸€è‡´ â†’ 404 Not Found ã‚¨ãƒ©ãƒ¼

## ä¾‹: ãƒãƒ£ãƒƒãƒˆAPIè¿½åŠ æ™‚
```yaml
# template.yaml
ChatsAPI:
  Type: Api
  Properties:
    Path: /api/chats
    Method: ANY
ChatsDetailAPI:
  Type: Api  
  Properties:
    Path: /api/chats/{chatId}
    Method: ANY
```
